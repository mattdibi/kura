
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Application developer guide - Eclipse Kura™ Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#application-developer-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
Eclipse Kura™ 5.2.0 is available! Check out the new release at: <a href="https://www.eclipse.org/kura/downloads.php">Eclipse Kura Downloads</a>.

          </div>
        </aside>
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
              
You are viewing the documentation relative to the develop branch or to an outdated version. This means the features might be different than the ones of the latest stable release, or not yet published.
<a href="../../.."> 
    <strong>Click here to go to latest stable release.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Eclipse Kura™ Documentation" class="md-header__button md-logo" aria-label="Eclipse Kura™ Documentation" data-md-component="logo">
      
  <img src="../../assets/kura_logo_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Eclipse Kura™ Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Application developer guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../intro/raspberry-pi-raspbian-quick-start/" class="md-tabs__link">
        Introduction
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../config/console/" class="md-tabs__link">
        Configuration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../builtin/intro/" class="md-tabs__link">
        Built-in services
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../admin/directory-layout/" class="md-tabs__link">
        Administration
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../overview/" class="md-tabs__link md-tabs__link--active">
        Cloud Connection API and usage
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Eclipse Kura™ Documentation" class="md-nav__button md-logo" aria-label="Eclipse Kura™ Documentation" data-md-component="logo">
      
  <img src="../../assets/kura_logo_small.png" alt="logo">

    </a>
    Eclipse Kura™ Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/raspberry-pi-raspbian-quick-start/" class="md-nav__link">
        Raspberry Pi - Raspbian Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/raspberry-pi-ubuntu-20-quick-start/" class="md-nav__link">
        Raspberry Pi - Ubuntu 20 Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/docker-quick-start/" class="md-nav__link">
        Docker Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/intel-up-2-quick-start/" class="md-nav__link">
        Intel Up² Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/nvidia-jetson-nano-quick-start/" class="md-nav__link">
        NVIDIA Jetson Nano&trade; - Quick Start
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/console/" class="md-nav__link">
        Gateway Administration Console
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/device-information/" class="md-nav__link">
        Device Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/gateway-status/" class="md-nav__link">
        Gateway Status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/network-configuration/" class="md-nav__link">
        Network Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ethernet-configuration/" class="md-nav__link">
        Ethernet Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/wi-fi-configuration/" class="md-nav__link">
        Wi-Fi Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/firewall-configuration/" class="md-nav__link">
        Firewall Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/cloud-services/" class="md-nav__link">
        Cloud Connections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/cloud-service-configuration/" class="md-nav__link">
        Cloud Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/data-service-configuration/" class="md-nav__link">
        Data Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/connection-monitors/" class="md-nav__link">
        Connection Monitors in DataService
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/message-publishing-backoff-delay/" class="md-nav__link">
        Message Publishing Backoff Delay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/mqttdata-transport-service-configuration/" class="md-nav__link">
        MqttData Transport Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ssl-configuration/" class="md-nav__link">
        SSL Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/auth/" class="md-nav__link">
        Gateway Administration Console Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/threat-manager/" class="md-nav__link">
        Network Threat Manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Built-in services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Built-in services" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Built-in services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/simple-artemis-mqtt-broker-service/" class="md-nav__link">
        Simple Artemis MQTT Broker Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/activemq-artemis-broker-service/" class="md-nav__link">
        ActiveMQ Artemis Broker Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/clock-service/" class="md-nav__link">
        Clock Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/deployment-service/" class="md-nav__link">
        Deployment Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/cloudcat/" class="md-nav__link">
        Cloudcat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/command-service/" class="md-nav__link">
        Command Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/h2-database/" class="md-nav__link">
        H2 Database - Features and Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/h2-database-external-connections/" class="md-nav__link">
        H2 database - Connecting external applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/position-service/" class="md-nav__link">
        Position Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/rest-service/" class="md-nav__link">
        REST Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/watchdog-service/" class="md-nav__link">
        Watchdog Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/nvidiatm-triton-server-inference-engine/" class="md-nav__link">
        Nvidia™ Triton Server inference engine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/container-orchestration-provider/" class="md-nav__link">
        Container Orchestration Provider
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Administration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/directory-layout/" class="md-nav__link">
        Directory Layout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/snapshot-management/" class="md-nav__link">
        Snapshots Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/application-management/" class="md-nav__link">
        Application Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/remote-management-with-ec/" class="md-nav__link">
        Remote Management with Everyware Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/remote-management-with-kapua/" class="md-nav__link">
        Remote Management with Eclipse Kapua
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/keystore-management/" class="md-nav__link">
        Keystores Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/keys-and-certificates/" class="md-nav__link">
        Keys and Certificates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cloud Connection API and usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cloud Connection API and usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cloud Connection API and usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/" class="md-nav__link">
        User guide
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Application developer guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Application developer guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-write-component-definition" class="md-nav__link">
    1. Write component definition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-component-metatype" class="md-nav__link">
    2. Create component metatype
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-write-the-bindunbind-methods-in-applicaiton-code" class="md-nav__link">
    3. Write the bind/unbind methods in applicaiton code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-publish-a-message" class="md-nav__link">
    4. Publish a message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-receiving-messages-using-a-cloudsubscriber" class="md-nav__link">
    5. Receiving messages using a CloudSubscriber
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-receiving-connection-state-notifications" class="md-nav__link">
    5. Receiving connection state notifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-receiving-message-delivery-notifications" class="md-nav__link">
    6. Receiving message delivery notifications
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stack-dev-guide/" class="md-nav__link">
        Cloud connection developer guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stack-components/" class="md-nav__link">
        Built-in Cloud Services
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-write-component-definition" class="md-nav__link">
    1. Write component definition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-component-metatype" class="md-nav__link">
    2. Create component metatype
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-write-the-bindunbind-methods-in-applicaiton-code" class="md-nav__link">
    3. Write the bind/unbind methods in applicaiton code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-publish-a-message" class="md-nav__link">
    4. Publish a message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-receiving-messages-using-a-cloudsubscriber" class="md-nav__link">
    5. Receiving messages using a CloudSubscriber
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-receiving-connection-state-notifications" class="md-nav__link">
    5. Receiving connection state notifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-receiving-message-delivery-notifications" class="md-nav__link">
    6. Receiving message delivery notifications
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="application-developer-guide">Application developer guide</h1>
<p>This guide will provide information on how an application developer can leverage the new Generic Cloud Services APIs, in order to be able to properly use the CloudPublisher/CloudSubscriber API, publish a message, being notified of message delivery and of connection status changes.</p>
<p>The Kura <a href="https://github.com/eclipse/kura/tree/develop/kura/examples/org.eclipse.kura.example.publisher">ExamplePublisher</a> will be used as a reference.</p>
<p>The application should bind itself to a <code>CloudPublisher</code> or <code>CloudSubscriber</code> instance, this can be done in different ways, such as using OSGi <code>ServiceTracker</code>s or by leveraging the Declarative Service layer.</p>
<p>The recommended way to perform this operation is choosing the latter and allowing the user to customize the service references through component configuration.</p>
<p>If the component metatype and definition are structured as described below, the Kura Web UI will show a dedicated widget in component configuration that helps the user to pick compatible <code>CloudPublisher</code> or <code>CloudSubscriber</code> instances.</p>
<h2 id="1-write-component-definition">1. Write component definition</h2>
<p>The first step involves declaring the Publisher or Subscriber references in component definition:</p>
<pre><code class="language-xml">&lt;scr:component xmlns:scr=&quot;http://www.osgi.org/xmlns/scr/v1.1.0&quot;
    name=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;
    activate=&quot;activate&quot;
    deactivate=&quot;deactivate&quot;
    modified=&quot;updated&quot;
    enabled=&quot;true&quot;
    immediate=&quot;true&quot;
    configuration-policy=&quot;require&quot;&gt;
&lt;implementation class=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;/&gt;

&lt;!-- If the component is configurable through the Kura ConfigurationService, it must expose a Service. --&gt;
&lt;property name=&quot;service.pid&quot; type=&quot;String&quot; value=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;/&gt;
&lt;service&gt;
    &lt;provide interface=&quot;org.eclipse.kura.configuration.ConfigurableComponent&quot;/&gt;
&lt;/service&gt;

&lt;reference name=&quot;CloudPublisher&quot;
        policy=&quot;static&quot;
        bind=&quot;setCloudPublisher&quot;
        unbind=&quot;unsetCloudPublisher&quot;
        cardinality=&quot;0..1&quot;
        interface=&quot;org.eclipse.kura.cloudconnection.publisher.CloudPublisher&quot;/&gt;
&lt;reference name=&quot;CloudSubscriber&quot;
        policy=&quot;static&quot;
        bind=&quot;setCloudSubscriber&quot;
        unbind=&quot;unsetCloudSubscriber&quot;
        cardinality=&quot;0..1&quot;
        interface=&quot;org.eclipse.kura.cloudconnection.subscriber.CloudSubscriber&quot;/&gt;
&lt;/scr:component&gt;
</code></pre>
<p>The snipped above shows the definition of Kura ExamplePublisher, this component is capable of sending and receiving messages, and therefore defines two references, the first to a <code>CloudPublisher</code> and the second to a <code>CloudSubscriber</code>.</p>
<p>In order to allow the user to customize the bindings at runtime, the <code>target</code> attribute of the references should not be specified at this point in component definition, as it will be set by the Web UI.</p>
<p>Reference cardinality should be use the <code>0..1</code> or <code>0..n</code> form, as it is not guaranteed that the references will point to a valid service instance during all the lifetime of the application component. For example, references can not be bound if the application has not been configured by the user yet or if the target service is missing.</p>
<h2 id="2-create-component-metatype">2. Create component metatype</h2>
<p>Application metatype should declare an <code>AD</code> for each Publisher/Subscriber reference declared in component definition:</p>
<pre><code class="language-xml">&lt;MetaData xmlns=&quot;http://www.osgi.org/xmlns/metatype/v1.2.0&quot; localization=&quot;en_us&quot;&gt;
    &lt;OCD id=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;
        name=&quot;ExamplePublisher&quot;
        description=&quot;Example of a Configuring Kura Application.&quot;&gt;

    &lt;!-- ... --&gt;

        &lt;AD id=&quot;CloudPublisher.target&quot;
            name=&quot;CloudPublisher Target Filter&quot;
            type=&quot;String&quot;
            cardinality=&quot;0&quot;
            required=&quot;true&quot;
            default=&quot;(kura.service.pid=changeme)&quot;
            description=&quot;Specifies, as an OSGi target filter, the pid of the Cloud Publisher used to publish messages to the cloud platform.&quot;&gt;
        &lt;/AD&gt;

        &lt;AD id=&quot;CloudSubscriber.target&quot;
            name=&quot;CloudSubscriber Target Filter&quot;
            type=&quot;String&quot;
            cardinality=&quot;0&quot;
            required=&quot;true&quot;
            default=&quot;(kura.service.pid=changeme)&quot;
            description=&quot;Specifies, as an OSGi target filter, the pid of the Cloud Subscriber used to receive messages from the cloud platform.&quot;&gt;
        &lt;/AD&gt;

        &lt;!-- ... --&gt;

        &lt;/OCD&gt;
    &lt;Designate pid=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot; factoryPid=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;&gt;
        &lt;Object ocdref=&quot;org.eclipse.kura.example.publisher.ExamplePublisher&quot;/&gt;
    &lt;/Designate&gt;
&lt;/MetaData&gt;
</code></pre>
<p>It is important to respect the following rules for some of the <code>AD</code> attributes:</p>
<ul>
<li>
<p><code>id</code>: this attribute must have the following form:</p>
<p><code>&lt;reference name&gt;.target</code></p>
<p>where <code>&lt;reference name&gt;</code> should match the value of the <code>name</code> attribute of the corresponding reference in component definition.</p>
</li>
<li>
<p><code>required</code>: must be set to <code>true</code></p>
</li>
<li>
<p><code>default</code>: must not be empty and must be a valid OSGi filter.</p>
</li>
</ul>
<p>The Web UI will renderer a dedicated widget for picking <code>CloudPublisher</code> and <code>CloudSubscriber</code> instances:</p>
<p><img alt="cloud-connections" src="https://s3-us-west-2.amazonaws.com/kura-repo/kura-github-wiki-images/generic-cloud-services/cloud-connections-user-7.png" /></p>
<h2 id="3-write-the-bindunbind-methods-in-applicaiton-code">3. Write the bind/unbind methods in applicaiton code</h2>
<p>The last step involves defining some <code>bind...()</code>/<code>unbind...()</code> methods with a name that matches the values of the <code>bind</code>/<code>unbind</code> attributes of the references in component definition.</p>
<pre><code class="language-java">public void setCloudPublisher(CloudPublisher cloudPublisher) {
    ...
}

public void unsetCloudPublisher(CloudPublisher cloudPublisher) {
    ...
}

public void setCloudSubscriber(CloudSubscriber cloudSubscriber) {
    ...
}

public void unsetCloudSubscriber(CloudSubscriber cloudSubscriber) {
    ...
}
</code></pre>
<p>As stated above, since reference cardinality is declared as <code>0..</code>, the application must be prepared to handle the cases where references are not satisfied, and therefore <code>CloudPublisher</code> and <code>CloudSubscriber</code> instances are not available.</p>
<h2 id="4-publish-a-message">4. Publish a message</h2>
<p>If a <code>CloudPublisher</code> instance is bound, the application can publish messages using its <code>publish()</code> method:</p>
<pre><code class="language-java">if (nonNull(this.cloudPublisher)) {
    KuraMessage message = new KuraMessage(payload);
    String messageId = this.cloudPublisher.publish(message);
}
</code></pre>
<h2 id="5-receiving-messages-using-a-cloudsubscriber">5. <strong>Receiving messages using a CloudSubscriber</strong></h2>
<p>In order to receive messages from a <code>CloudSubscriber</code>, the application must implement and attach a <code>CloudSubscriberListener</code> to it.</p>
<p>This can be done for example during <code>CloudSubscriber</code> binding:</p>
<pre><code class="language-java">  public class ExamplePublisher implements CloudSubscriberListener, ... {

  ...

   public void setCloudSubscriber(CloudSubscriber cloudSubscriber) {
    this.cloudSubscriber = cloudSubscriber;
    this.cloudSubscriber.registerCloudSubscriberListener(ExamplePublisher.this);
    ...
  }

  public void unsetCloudSubscriber(CloudSubscriber cloudSubscriber) {
    this.cloudSubscriber.unregisterCloudSubscriberListener(ExamplePublisher.this);
    ...
    this.cloudSubscriber = null;
  }

  ...

  @Override
  public void onMessageArrived(KuraMessage message) {
    logReceivedMessage(message);
  }

  ...

  }
</code></pre>
<p>The CloudSubscriber will invoke the <code>onMessageArrived()</code> method when new messages are received.</p>
<h2 id="5-receiving-connection-state-notifications">5. Receiving connection state notifications</h2>
<p>If an application is interested in cloud connection status change events (connected, disconnected, etc), it can implement and attach a <code>CloudConnectionListener</code> to a <code>CloudPublisher</code> or <code>CloudSubscriber</code> instance.</p>
<pre><code class="language-java">  public class ExamplePublisher implements CloudConnectionListener, ... {

  ...

  public void setCloudPublisher(CloudPublisher cloudPublisher) {
    this.cloudPublisher = cloudPublisher;
    this.cloudPublisher.registerCloudConnectionListener(ExamplePublisher.this);
    ...
  }

  public void unsetCloudPublisher(CloudPublisher cloudPublisher) {
    this.cloudPublisher.unregisterCloudConnectionListener(ExamplePublisher.this);
    ...
    this.cloudPublisher = null;
  }

  public void setCloudSubscriber(CloudSubscriber cloudSubscriber) {
    this.cloudSubscriber = cloudSubscriber;
    ...
    this.cloudSubscriber.registerCloudConnectionListener(ExamplePublisher.this);
  }

  public void unsetCloudSubscriber(CloudSubscriber cloudSubscriber) {
    ...
    this.cloudSubscriber.unregisterCloudConnectionListener(ExamplePublisher.this);
    this.cloudSubscriber = null;
  }

  ...

  @Override
  public void onConnectionEstablished() {
    logger.info(&quot;Connection established&quot;);
  }

  @Override
  public void onConnectionLost() {
    logger.warn(&quot;Connection lost!&quot;);
  }

  @Override
  public void onDisconnected() {
    logger.warn(&quot;On disconnected&quot;);
  }

  ...

  }
</code></pre>
<h2 id="6-receiving-message-delivery-notifications">6. Receiving message delivery notifications</h2>
<p>If an application is interested in message confirmation events and the underlying cloud connection supports it, it can implement and attach a <code>CloudDeliveryListener</code> to a <code>CloudPublisher</code> instance.</p>
<pre><code class="language-java">  public class ExamplePublisher implements CloudDeliveryListener, ... {

  ...

  public void setCloudPublisher(CloudPublisher cloudPublisher) {
    this.cloudPublisher = cloudPublisher;
    ...
    this.cloudPublisher.registerCloudDeliveryListener(ExamplePublisher.this);
  }

  public void unsetCloudPublisher(CloudPublisher cloudPublisher) {
    ...
    this.cloudPublisher.registerCloudDeliveryListener(ExamplePublisher.this);
    this.cloudPublisher = null;
  }

  ...

  @Override
  public void onMessageConfirmed(String messageId) {
    logger.info(&quot;Confirmed message with id: {}&quot;, messageId);
  }

  ...

  }
</code></pre>
<p>The CloudSubscriber will invoke the <code>onMessageConfirmed()</code> method when a published message is confirmed.</p>
<p>In order to determine which message has been confirmed, the provided <code>messageId</code> can be compared with the id returned by the <code>publish()</code> call that published the message.</p>
<p>Please note that if the underlying cloud connection is not able to provide message confirmation for the published message, the id returned by <code>publish()</code> will be <code>null</code>.</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../user-guide/" class="md-footer__link md-footer__link--prev" aria-label="Previous: User guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              User guide
            </div>
          </div>
        </a>
      
      
        
        <a href="../stack-dev-guide/" class="md-footer__link md-footer__link--next" aria-label="Next: Cloud connection developer guide" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cloud connection developer guide
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>